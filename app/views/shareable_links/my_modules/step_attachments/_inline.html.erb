<div class="inline-attachment-container asset">
  <div class="header">
    <div class="file-info">
      <%= link_to asset.file.url(expires_in: Constants::URL_SHORT_EXPIRE_TIME.minutes),
        class: "file-preview-link file-name",
        id: "modal_link#{asset.id}",
        data: {
            no_turbolink: true,
            id: asset.id,
            gallery_view_id: step.id,
            preview_url: shared_file_preview_url(asset.signed_id(expires_in: Constants::URL_SHORT_EXPIRE_TIME.minutes))
          } do %>
        <span data-toggle="tooltip"
              data-placement="bottom"
              title="<%= escape_input(asset.render_file_name) %>">
          <%= escape_input(asset.render_file_name) %>
        </span>
      <% end %>
      <div class="file-metadata">
        <span><%= t('assets.placeholder.modified_label') %> <%= l(asset.updated_at, format: :full_date) if asset.updated_at %></span>
        <span><%= t('assets.placeholder.size_label', size: number_to_human_size(asset.file_size)) %></span>
      </div>
    </div>
    <%= render partial: "shareable_links/my_modules/step_attachments/context_menu", locals: { asset: asset } %>
  </div>
  <% if wopi_enabled? && wopi_file?(asset) %>
    <% if asset.file_size.positive? %>
      <div class="iframe-placeholder" data-iframe-url="<%= asset.get_action_url(current_user, 'embedview', false) %>"></div>
    <% else %>
      <div class="empty-office-file">
        <h2><%= t('assets.empty_office_file.description') %></h2>
        <%= link_to(load_asset_path(asset),
                        remote: true,
                        class: 'btn btn-primary reload-asset',
                        params: { asset: {view_mode: asset.view_mode }}) do %>
            <%= t('assets.empty_office_file.reload') %>
          <% end %>
      </div>
    <% end %>
  <% elsif asset.pdf_previewable? %>
    <%= render partial: 'shared/pdf_viewer', locals: { asset: asset, report_document: false, shareable_document: true } %>
  <% elsif asset.previewable? %>
    <div class="image-container">
      <%= image_tag asset.file.representation(resize_to_limit: Constants::LARGE_PIC_FORMAT).url(expires_in: Constants::URL_SHORT_EXPIRE_TIME.minutes),
          class: 'asset-inline-image',
          style: 'opacity: 0' %>
    </div>
    <%= javascript_include_tag 'assets/asset_inline' %>
  <% else %>
    <div class="general-file-container">
      <i class="fas <%= file_fa_icon_class(asset) if asset.file_name %>"></i>
    </div>
  <% end %>
</div>
